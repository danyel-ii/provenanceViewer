# cubixles_ Provenance Viewer (Read-only)

A read-only, off-chain provenance viewer for NFTs minted on the CUBIXLES_CONTRACT. The app inspects metadata, mint transactions, and ownership overlap to infer relationships without ever signing or writing on-chain.

## Requirements
- Node.js 18+
- Alchemy API key
- CUBIXLES contract + network env vars

## Setup
```bash
npm install
npm run dev
```

If you hit npm cache permission issues, use `npm install --cache .npm-cache`.

Copy `.env.example` to `.env.local` and fill in values:
- `ALCHEMY_KEY` (or `ALCHEMY_API_KEY`)
- `CUBIXLES_CONTRACT` (or `CUBIXLES_CONTRACT_ADDRESS`) — mainnet: `0x61EdB3bff9c758215Bc8C0B2eAcf2a56c638a6f2`
- `NETWORK` (or `CUBIXLES_CHAIN_ID`/`BASE_CHAIN_ID` for auto-mapping)
- Optional: `CUBIXLES_BASE_CONTRACT_ADDRESS` — Base: `0x428032392237cb3BA908a6743994380DCFE7Bb74` (not used yet)
- `NEXT_PUBLIC_BASE_PATH` (default `/inspecta_deck` for subpath deployments)
- `NEXT_PUBLIC_BASE_URL` (optional absolute URL for server-side metadata/linking)

Optional caching and rate limits:
- `CACHE_PROVIDER` (`memory`, `redis`, `kv`)
- `REDIS_URL`
- `CACHE_TTL_*`
- `VERIFY_RATE_LIMIT`, `VERIFY_RATE_WINDOW_SECONDS`
- `KV_REST_API_URL`, `KV_REST_API_TOKEN`, `KV_REST_API_READ_ONLY_TOKEN`
- `HELPDESK_RATE_LIMIT`, `HELPDESK_RATE_WINDOW_SECONDS`

Optional mint audit enrichment:
- `ALCHEMY_API_KEY` (used by `/m/[tokenId]` metadata lookups)
- `MAINNET_RPC_URL` + `CUBIXLES_CONTRACT_ADDRESS` (enables `alchemy_getAssetTransfers`)

## API endpoints
- `GET /api/poc/tokens?limit=&pageKey=&all=true&maxPages=`
  - Proof-of-concept list of tokens from CUBIXLES_CONTRACT.
  - Use `pageKey` for pagination; `all=true` aggregates pages (capped by `maxPages`).
- `GET /api/token/:id`
  - Token metadata + mint info (read-only).
- `GET /api/token/:id/provenance`
  - Heuristic provenance candidates with confidence + evidence.
- `POST /api/token/:id/verify`
  - Read-only verification (ownerOf + tokenURI). Rate limited.
- `POST /api/help`
  - RAG helpdesk endpoint (returns answer + citations).

## Frontend routes
All routes are served under `NEXT_PUBLIC_BASE_PATH` when configured (default `/inspecta_deck`).
- `GET /` or `GET /landing`
  - Landing page + live token list.
- `GET /token/[id]`
  - Token viewer that renders metadata, provenance candidates, and verification UI.
- `GET /m/[tokenId]`
  - Mint audit view (uses optional enrichment if configured).
- `GET /help`
  - Helpdesk UI with citations.

## Limits and assumptions
- Provenance is heuristic and can be incomplete.
- Only tokens from `CUBIXLES_CONTRACT` are valid.
- No wallet connections, signing, or on-chain writes are permitted.
- Metadata is resolved through IPFS/Arweave gateways and cached with TTLs.

## Signature
```
f---------------------------------------------------------------------------------------------------
r-+#*#****+##*#**#***+#***+#+**+#+++=+=+-=--=-------------------------------------------------------
e-#@@@@@@@%%%%%%%%#%##%#%%*#*####***++=+===------==--===-=-=-=-==-=-===-===========+=+=++++++=*+*=--
e-#@@@@%%@%%%##%#*#*##**+**+*+++=======-----+#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###*+==--
p-*@@%@%%@*#%+##=+#=++=*=+=-====-------=---##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%#*%@%@@@@@@+--
a-*%@%%%%%***++==++==----------------------%%@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%#@%@%%%@%*--
l-*%%%%%##*++=====-------------------------@%@@%%@@@%%##################%%%%@@%%%%#@@@@%#@%@%@%@@+--
e-*#@#%%*#==+-==------------------------=--@#@@*@@-==+===============---=-=---==+@@#@%@%#@%@%%%@%+--
s-*%%###+*+==---------------======---------%#@@*@*-=++========+%**--------++=-==-#@#@@@%#@%@%%%@@+--
t-+**#+*+==----=-------+##%@@@@@@@@@%#+==--*##%*%*-=====------*%%%*+=--=+#%*#+-==#%#@%@%#@%@%%@@@*--
i-****=+=-----------+@##%##%@@@%***#%@@@@@@@%++=#+-=====------+%*#**%%@%%@%%#=-=-#%#@@@%#@#@%@%@@+--
n-+*+===----------*#+*##%@@@@@@@%#**%@@@#@@%%%@#+=-=----=+=----#*++-----=#*#*--==#%#@@@%#@#@%%@@@+--
e-=+==----------*#*%@%%***#%@@@@@@@##%@@@@@@@%#%@#----*#+===#+-+%+*=----##*%=--==#%#@@@%%@#@%%@@@*--
f-===----------%#@@@@%#*++*#*#@@@@@@@@@@@@@@@@%%@@@+-%%#+=-+=#=-#%*%+--%**%+---==#%#@@@%%@%@%%@@@+--
r---=----=----+@%@@@@@@@@@%@%%**%#%%@@@@@@@@@%%@@@@@@*+@%#+====#+-*%*#%#+*#=--====#%%@%%%%@#@@%@@@*--
e-------=----+@@@@@@@@@@@@@@@@%%+=+*###%@@%%%%%*#%@%%@%*%%*+***##--*%*++#%==+=====%%#*#%#%@#@@@@@@+--
e-------=---+@@@@@@@@@@@@@@@@@@@@%*+=*==++*++%@@##*+*#@%+#%#**%%=---#%*#@=-======-%%%@@@%#@#@@@@@@+--
p----------=@@@@@@@@@@@@@@@@@@@@@%@@#%%##@%###+%@@@@%@@@%+*#%%#=-==-#%**%--======-%%#@@@%%@#@@@@@@*--
a---------=@@@@@@@@@@@@@@@@@@@@@@@%#@@@@*@@@%==+%@%%@@@@%%=++=-==-=-##+*%--======-%%####%%@#@@@@@@+--
l--------=%@@@@@@@@@@@@@@@@@@@@@@*#@@@%*#@@#---=#@*+%@@@@%*-=====---##+#@-=======-%#%%#@%%@#@@@@@@+--
e-------=%@%%@@@@@@@@@@@@@%%@@#*#@@@#++*@@*----=%%==*@@@@#%-=======-%%*#%========-%#%@@@%%@%@@@@@@+--
s------+@@%%@@@@@@@@@@@**#*++#@@@*++==#%+---=--=#=--+@@@@##-========%###%=-=======%#%@%@%%@%@@%@@@+--
t-----+#%%@@@@@@@@@@@%**#%@@%%*+===-=+=-===-=----=*%%@@@%+-==-======#%#%%=-======-%#%@@@%%@%@@@@@@+--
i----**@@@@@%#%#+%@@@#*#**##%@@@@%*+---+++++-=*%@@@%%@@@#=====---==-=+**=-========%#%@@@#%@%@@%@@@+--
n---*+%@@@@@*%@@@@@@@#**#%@@@%%%@@@@@@#+==+%@@@##***#@@@#==++**####%%##*++==----=#@#%@@@#%@%@@%@@@+--
e--==@@@@@@@*#*@@@@@%*+++##+@@@%+#@#**+=-=#@@@@@=*%+%@@@@++#%@@@@%##****####%%%%@@@*@@@@#%@%@@@@@@+--
f--=@@@@@@@@#*#@%#@@%*++=+#**#*+-=+*+++===+#+##++#+=%@@@%@++####%%%@@@@@@@@@@@@@%%%@@@@@#%@%@@@@@%=--
r--+@@%@@@@@@***@#%%%*++===+#%##*=---==+===-+*#%*===@@@@#****%@@@@@@@%##**#%@@@@@@@@@@@@#%@@@@@%#*+--
e--+@@#%@@@@@%***#****+++=---===----+++==+*+-=+=---+@@@@@#-=+*###%%%%%%@@@@@@@@@@%#***##*@@@@%#@@@*--
e---#@*%@@@@@@@@%@%*####*+==-------+%@@%#%%%-------%@@@@@@*==+++**+****####%%@@@@@@%#%@@@@@@@@@@@%+--
p----+*#@@%@@@@@@@+**=+#+=%*==------+*%@@#=-------+@@@@@%@@====+=====+===+====+*#%@@#*@@@@@%%%%%%#+--
a---==--*@@+%@@@@##%++#=-==+*=--------===--------+@@@@@@%*%-========++**##%@%%#%%*+++++********#*+=--
l---==---=++*@@@@#%*+#+=-+#+%==--=*##%#####*----+@@@@@@@**+-+%%%%####*******+**+++***###*+++==+=+=---
e----=---=#@@@@@%##+*+=--==%@#+=--=-=+***=----+@@@@@%@@#=---*#*+*#@%*+++**++++++###%%#*+==++#==+==---
s---=--=#@%%@@@@%##***+=------=##+==+=====--+%@@@@@%@%@+-==-*#@@@@@%##%%%%%#**+==+++++=----*#=====---
t--=--*@@@%%%%@@@@%#****++=------+#+======*@@@@@@@%*+#@@*===*#%#%%%@@@@@@%++===+=+=++*=++--*#=+=++---
i----%%#%@@@@@@@%@@@@#****++==-----#@##%@@@@@%##@@%*#@@*%===*#%*%****@@@@%++-+#+-**#+**%=--*#++==+=--
n---%@@@%%@@%#%@@@@@@@@@#***++==---*@@@@@@%@%#*@@@*%*+#+*#-=##%%#**##**#@%++-++#+**+++=+---*#+=++==--
e--*@@@@###%@%#@%%@@%%@@@@%#**+=---#@%%@@##+@@@++#@%+%@+=%+=###*%%#@@%%%%%+++++--+#+++=#*+**#+=++==--
f--%@@@@%%*%@@@@@%%@@@@@@@****+=--=%@@%*+%+*@@%++@@#%@%#@@@=*##*#+**###%@%++**=#**#=%#=###++#++=+==--
r-=%@#*#@@@%+*%@%%@%%@@@@#**+=----*@%*#%@@@#*#%%%%%%%#=*@@@**#%@@@%%*###*%++*#**+++=--==+*-*#+++*+=--
e-=%@###@@@@+++%@%#@%@@@#**+=----=@@@#**@@%*+#@@#%@@#+*##++%##%@%%%#%@@%%%++=--=+*#%@@@@@@-*#+++++=--
e-=@@@@@##++%@@%@@%@@@@%*++==----#%%%%%%%%%%%%%%#@@@%@@@%+=*##@@@#%@@@@@@%++*@@@@%+++*%@@@-*#+=*++=--
p-+%%@@@#+*#%@@@%#%@@@%++*==----+@#%@@@*+*@@@#+%@@%#%@@%#%%%##%@@*%#%@@@@%++*@@##*+===+*@@=*#+*+++=--
a-=%%@%#@@@@%*#%@%%@@%+++==-----#@%@@@#+*@@@@*#@@@%%@%*+=#@#####@##*#@@@@%++*@%%+++===++#@-*#**+*+=--
l-=%@##*@@@@@#%%%@%%%*++==-----+@@%**#@@%**+@@%@@%@@@@**%@==*#####%@@@@@@%++*@%%%%*##+=+#@-*#+*#**=--
e-=%@%#%@*###@@@@#*@#*++=------#@@#*#@@@##*%@@%@@#@@%#@@@@#=*##@%##*+#*##%++*@@#**=+===%%@-*#*%%%%+--
s-=%@%@@@%%@%%@@@#@@%**+=-----=%%@@@###@@@@%%@@%@@@%%%@##*#####@@@@@@@%%%%++*@@#*#++==+#@@=*%#%%%%+--
t-=%%%@@@@@%%@@@@@@@%%*+------*@@@@%##%@@@@@@@@%@@@@@@@@@@#####@@@@@@@@@@%++*@@#%*===+*##@=*%%%@@@*--
i-=%%%%%@@@@@%#@#+#@*+%*==----%@@%@@@@%@@@@@%##@@@@#+=+%@#++###@@@@@@@@@@%++*@@@%*+*#*=+*%-*%%@@@@*--
n-+@@@%@@%@@%%*%+++#*=-+%%#=-*@@@@@@%#*%%%%%+=-=#%#**%@@@%#+###@@@@@@@@@%%++*@@@@@%%#+===*-*@@@@@@+--
e-+@@@@@%%%@@%@@#=#@@%=+@@@@%*+*#=+#%===#@%#*@@@@*===#@@@%==*#%@@@@@@@%@@%++*@@@@%@%+=+*==-*%%@@@@+--
f-+@@@%@%%@@@@@@@%@@@@@#%@@@*=+%+-=+%@%%%*--=#@@@%**#%%*++@*##%@@@@@@@@@@%++*@@%%#%++**+++-*#+****=--
r-+%@@#@@@%%@#@@%++%@@*--=+#%%@#=--+*@@@@%++*#*+++%@@@%===++##%@@@@@@@@%@%++*@%%##+**#**++-*#+++++=--
e-+%@@@@@@%%@##@+===+#=---#@@@%+=+++*%*==+%@@@*===#%%#++*%@@@#%@@@@@@@@@%%++*@#%#*++#*#=++=*@@#++==--
e-+%%@@@%@@#%%%@%+==#%@@%*%%%@*****##%#+++#@%#***##%%%%%%%%%@#%@@@@@@@@@@%++*@%@%+#####*#*=*#***#%+--
p-+@@@@@@%#@@@@@@@#%@@@@%+=*@@@@@@@@@%###%%%###*#####%%%%%%@@#%@@@@@@@@@@%++*@%@*##*%#*+===*#++===---
a-=%%%@@@@@@@@@@@%++*@@%++#@@@@%%%%%@@#+********++***###%%%@@%%@@@@@@@@@@%++*@@%*+=====+==+##======--
l-=##%%%%@@@@@%##+****%@@@%%##%##*#%@%####*+++=++==++++**#%%%@@%%%@@@@@@@%++====+====+###*+=====+*=--
e-=******#*#%%@@@@@@@@@%##****++*+#%@%@@@@%#**%#=====++=++++*###@@%%%@@@@%++====*#%#+++===+=+#%**%+--
s-=+++**+++*++**++**+=+++=+++==++=#%@#@%%%%%%@@#*#@%*+++==+++=++++*#%@%###+*#@#*======+=+%%**%@%%*=--
t-=%%*+===+===+============++++**#%%@#@%#######%%@@%#####*+========+==+++*+==+====+*#####%@#***+++=--
i-+%%%%%%*=--===-=====++==+++**#%%@%@#@%###*#*#*###%%@@@%#*#%#+=======++=+==+=*%#+*%%%#***+++++=++=--
n-=#%%%%%%%@%+=--=====+===+++*#%%@@%@#@%%##*********####%%@@@#+#@%*+====++*%#+*%@%**+*++++==+=++++---
e-=%@@@%#%%%%%%%#+====+===+++*##%@@@@%%@%%##*#*******#*#####%%@@@%###%#####%%***++=++++=+=++++++**=--
f-=%@@@@@@@%%%%%%%%%*=======++++*%%%@@@@##@%%##***#***#****####%%%@@@@@%#*+++++++=++==+++++++*##*#+--
r-=%@@@@@@@@@@%@%%%%%%%%+=--=+==+++*###%%@@%*%%%##**#***#*#***###%%@%++++++=+==+===++++++*##**%%*+=--
e-=%@@@@@@@@@@@@@%%%%%%%%%%#+=======+++*###%@@@%#%%%####***#*#*###%@*++==+==+=+=+++++*####%##++==+---
e-=%@@@@@@@@@@@@@@@@@%#%%%#%%%%#==-=++==++=+####@@@%*%@###%########%+===+=++=++*+*%%**%%*+=======+---
p-=%@%@%%@@@%@%@%@%@@@@@%#%%%%%%%%%+==-=+===++++###%@@@##%%%%%####%%+++++++++*#%#+#@#*+====+======---
a-=%@%@%%@@@%%%%%%%@@@@@@@@@%%%%%%%%%%#+-=-====+==+**#%%@@%##%@%%%%@*++++*##*##%%*++===========-=*=--
l-=%@%@%%@@@@@@%%%%%%%%%@@@@@@@@#%#%#%%%%%*=-=====++==**+*%%%@%*#@@%%*#%*+%@%#+====+==+====-=#%%##=--
e-=%@%@%%@@@@@@@@@%%%%%%%%@@@@@@@@@%%%%%%%%%@#+=--=====+==++++#%%@#*#**%%#*=++===========*%%##****=--
s-=#@%@#%%%@@@@@@@@@@@%%%%%%%%%@@@@@@@%%#%%%%%%%%#+--========+++=++*##*+=============*%%#*#*#*#*#%+--
t-=#@#%##%%@@@@%@@@@@@@@@%%%%%%%%%@%@@@@@@%%%#%%%#%%%*=--=+=-=+=-====+==+==+====-+%%##*#*##*##@@@%+--
i-=#@#%##%%@%%%%@@@%@@@@@@@@%%%%%%%%%@%@@@@@@@%%###%#%%@#+==--===============+#%###*#*##*#%@@%%###=--
n-=#@*%*#%%@%%%%@@%%@@%%%%%@@@@%%%%%%%%@%%%@@@@@@%##%%%#%%%%*=-==========+##%****#*#*#%@@@%%###*#*=--
e--*%*%*#%#%%%%%@@@@@@@%####%%@@@@%%%%%%#%%%@%%@@@@@%#%#%#%#%%%%+=====*%###***#***#@@%@%%%*####*#+=--
f--+#+#**%*%###%@@@@@@@@%#%@@@@%%@@@@%%%%%%%%%%@%@%%@@@@%%#%%%#%%%%#%##**#*#**#%@@%%%#%##***+*+*++=--
r--=++*+*#*##*##@%%@@%#++%@@@@@%#%@@@@@@@%%#%%%%#%%%%%@%@@@%%%%%%#%**+*****%%@@%####**#**++*++++==---
e-----=-=======+**+**+=+==*###**######%%#%%#***++*+#*##*###**##*++#+==+=*##*#***+*+=+========+-==----
e----------------------------------------------------------------------------------------------------
```
